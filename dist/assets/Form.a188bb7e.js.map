{"version":3,"file":"Form.a188bb7e.js","sources":["../../src/api/user.js","../../src/components/Form/Form.vue?vue&type=template&lang.js","../../src/components/Form/Form.vue"],"sourcesContent":["import axios from '../utils/request'\r\n\r\nconst baseUrl = import.meta.env.VITE_APP_BASE_PATH\r\n\r\n/**\r\n * @description: 登录接口 \r\n * @param {*} params\r\n * @return {*}\r\n */\r\nexport function apiPostLogin(params) {\r\n\treturn axios({\r\n\t\turl: baseUrl + '/login',\r\n\t\tmethod: 'POST',\r\n\t\tdata: params,\r\n\t\tconfig: {\r\n\t\t\tmd5: ['password']\r\n\t\t}\r\n\t})\r\n};\r\n\r\n/**\r\n * @description: 获取用户列表\r\n * @param {*}\t\tpage\t\t要搜索的页码\r\n * @param {*}\t\tpagesize\t每页大小\r\n * @param {*}\t\tquery\t\t查询内容\r\n * @param {*}\t\tkey\t\t\t查询字段\r\n * @return {*}\r\n */\r\nexport function apiGetUserList(params) {\r\n\treturn axios({\r\n\t\turl: baseUrl + '/user/list',\r\n\t\tmethod: 'GET',\r\n\t\tparams: params\r\n\t})\r\n}\r\n\r\n/**\r\n * @description: 添加用户\r\n * @param {*}\r\n * @return {*}\r\n */\r\n export function apiPutUser(params) {\r\n\treturn axios({\r\n\t\turl: baseUrl + '/user',\r\n\t\tmethod: 'PUT',\r\n\t\tdata: params,\r\n\t\tconfig: {\r\n\t\t\tmd5: ['password']\r\n\t\t}\r\n\t})\r\n}\r\n\r\n/**\r\n * @description: 修改用户\r\n * @param {*}\r\n * @return {*}\r\n */\r\n export function apiPostUser(params) {\r\n\treturn axios({\r\n\t\turl: baseUrl + '/user',\r\n\t\tmethod: 'POST',\r\n\t\tdata: params,\r\n\t\tconfig: {\r\n\t\t\tmd5: ['password']\r\n\t\t}\r\n\t})\r\n}\r\n\r\n/**\r\n * @description: 获取单个用户\r\n * @param {*}\r\n * @return {*}\r\n */\r\nexport function apiGetUser(params) {\r\n\treturn axios({\r\n\t\turl: baseUrl + '/user',\r\n\t\tmethod: 'GET',\r\n\t\tparams: params\r\n\t})\r\n}\r\n\r\n/**\r\n * @description: 删除用户\r\n * @param {*}\r\n * @return {*}\r\n */\r\n export function apiDeleteUser(params) {\r\n\treturn axios({\r\n\t\turl: baseUrl + '/user',\r\n\t\tmethod: 'DELETE',\r\n\t\tdata: params\r\n\t})\r\n}\r\n\r\n/**\r\n * @description: 设置用户权限\r\n * @param {*}\r\n * @return {*}\r\n */\r\n export function apiPostPower(params) {\r\n\treturn axios({\r\n\t\turl: baseUrl + '/user/power',\r\n\t\tmethod: 'POST',\r\n\t\tdata: params\r\n\t})\r\n}\r\n\r\n/**\r\n * @description: 发送用户验证码\r\n * @param {*}\tparams\r\n * @return {*}\r\n */\r\n export function apiToolEmailVerify(params) {\r\n\treturn axios({\r\n\t\turl: baseUrl + '/user/emailVerify',\r\n\t\tmethod: 'post',\r\n\t\tdata: params\r\n\t})\r\n};\r\n\r\n/**\r\n * @description: 邮箱验证码设置用户信息\r\n * @param {*}\tparams\r\n * @return {*}\r\n */\r\n export function apiToolEmailSetUser(params) {\r\n\treturn axios({\r\n\t\turl: baseUrl + '/user/emailSetUser',\r\n\t\tmethod: 'post',\r\n\t\tdata: params,\r\n\t\tconfig: {\r\n\t\t\tmd5: ['password']\r\n\t\t}\r\n\t})\r\n};","\n<el-dialog :title=\"title\" v-bind=\"$attrs\" width=\"33%\" :close-on-click-modal=\"false\" @close=\"cancel\" @closed=\"closed\">\n\t<el-form :model=\"rowData\" ref=\"form\" :rules=\"rules\" label-width=\"80px\" :inline=\"false\" size=\"small\">\n\n\t\t<!-- 用于屏蔽自动填充用户名密码 -->\n\t\t<input type=\"password\" class=\"hide\" />\n\t\t<input type=\"text\" class=\"hide\" />\n\n\t\t<el-form-item v-for=\"(value , key ) in formdata\" :key=\"key\" :label=\"value.label\" :prop=\"key\">\n\t\t\t<!-- 直接在template使用作用域插槽，暴露allRow,rowValue,rowKey -->\n\t\t\t<slot v-if=\"slotsKey.includes(key)\" :allRow=\"rowData\" :rowKey=\"key\" :name=\"key\" />\n\t\t\t<el-input v-else :type=\"value.type ? value.type : ''\" v-model=\"rowData[key]\"></el-input>\n\t\t</el-form-item>\n\n\t\t<div class=\"foot-button\">\n\t\t\t<el-button type=\"primary\" @click=\"submit\">确定</el-button>\n\t\t\t<el-button @click=\"cancel\">取消</el-button>\n\t\t</div>\n\t</el-form>\n</el-dialog>\n","<template>\r\n\t<el-dialog :title=\"title\" v-bind=\"$attrs\" width=\"33%\" :close-on-click-modal=\"false\" @close=\"cancel\" @closed=\"closed\">\r\n\t\t<el-form :model=\"rowData\" ref=\"form\" :rules=\"rules\" label-width=\"80px\" :inline=\"false\" size=\"small\">\r\n\r\n\t\t\t<!-- 用于屏蔽自动填充用户名密码 -->\r\n\t\t\t<input type=\"password\" class=\"hide\" />\r\n\t\t\t<input type=\"text\" class=\"hide\" />\r\n\r\n\t\t\t<el-form-item v-for=\"(value , key ) in formdata\" :key=\"key\" :label=\"value.label\" :prop=\"key\">\r\n\t\t\t\t<!-- 直接在template使用作用域插槽，暴露allRow,rowValue,rowKey -->\r\n\t\t\t\t<slot v-if=\"slotsKey.includes(key)\" :allRow=\"rowData\" :rowKey=\"key\" :name=\"key\" />\r\n\t\t\t\t<el-input v-else :type=\"value.type ? value.type : ''\" v-model=\"rowData[key]\"></el-input>\r\n\t\t\t</el-form-item>\r\n\r\n\t\t\t<div class=\"foot-button\">\r\n\t\t\t\t<el-button type=\"primary\" @click=\"submit\">确定</el-button>\r\n\t\t\t\t<el-button @click=\"cancel\">取消</el-button>\r\n\t\t\t</div>\r\n\t\t</el-form>\r\n\t</el-dialog>\r\n</template>\r\n\r\n<script>\r\n/**\r\n * @description: 基于elementui自定义form组件，用于快速完成固定的表单功能 \r\n * @param {props}\tformdate \t表单格式，如：{ key值: {label: '别名',value: '绑定值'}}\r\n * @param {props}\trow \t\t表单数据，新增时无数据，修改时从外部传入当前行的数据\r\n * @param {props}\trules \t\t校验规则，遵循element form组件中rules所使用的规则\r\n * @param {props}\ttitle \t\t标题\r\n * @param {methods}\tsubmitFrom\t表单确定\r\n * @param {methods}\tcancelFrom\t表单取消\r\n */\r\nexport default {\r\n\tname: 'Form',\r\n\tprops:{\r\n\t\t// 表单显示格式\r\n\t\tformdata: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: ()=>{},\r\n\t\t},\r\n\t\t// 表单显示数值\r\n\t\trow: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: ()=>{},\r\n\t\t},\r\n\t\t// 表单对应的规则\r\n\t\trules: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: ()=>{},\r\n\t\t},\r\n\t\ttitle: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '标题'\r\n\t\t}\r\n\t},\r\n\tdata(){\r\n\t\treturn {\r\n\t\t\t// ? 深拷贝row为子组件内部数据\r\n\t\t\trowData: {...this.row},\r\n\t\t\t// ? 根据row判断当前是添加还是修改,没有值为添加 0 ，有值为修改 1\r\n\t\t\ttype: Object.keys(this.row).length == 0 ? 0 : 1\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\t// ? 内部数据与props动态关联\r\n\t\trow(newValue){\r\n\t\t\tthis.rowData = {...this.row};\r\n\t\t\tthis.type = Object.keys(this.row).length == 0 ? 0 : 1;\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tslotsKey() {\r\n\t\t\treturn Object.keys(this.$scopedSlots)\r\n\t\t}\r\n\t},\r\n\tmounted(){\r\n\t\tconsole.log(this.slotsKey)\r\n\t\tthis.init();\r\n\t},\r\n\tmethods: {\r\n\t\tinit(){\r\n\t\t\t\r\n\t\t},\r\n\t\t// 确定修改\r\n\t\tsubmit(){\r\n\t\t\tthis.$refs['form'].validate(state => {\r\n\t\t\t\tif(state){\r\n\t\t\t\t\tthis.$emit('update:visible', false)\r\n\t\t\t\t\tthis.$emit('submitFrom',{...this.rowData},this.type);\t\t// 解构赋值数据，去除__ob__监视器\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 取消修改，在父组件中定义关闭\r\n\t\tcancel(){\r\n\t\t\tthis.$emit('update:visible', false)\r\n\t\t\tthis.$emit('cancelForm');\r\n\t\t},\r\n\t\t// 关闭动画回调\r\n\t\tclosed(){\r\n\t\t\tthis.$refs['form'].resetFields();\t// 清除表单验证，动画中清除表单符合观感\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.foot-button{\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n}\r\n// 用隐藏输入框隐藏自动填充密码\r\n.hide{\r\n\twidth: 0;\r\n\tborder: 0;\r\n\tposition: absolute;\r\n}\r\n</style>"],"names":[],"mappings":"saAEA,KAAM,GAAU,GAOT,WAAsB,EAAQ,CACpC,MAAO,GAAM,CACZ,IAAK,EAAU,SACf,OAAQ,OACR,KAAM,EACN,OAAQ,CACP,IAAK,CAAC,eAaF,WAAwB,EAAQ,CACtC,MAAO,GAAM,CACZ,IAAK,EAAU,aACf,OAAQ,MACR,OAAQ,IASF,WAAoB,EAAQ,CACnC,MAAO,GAAM,CACZ,IAAK,EAAU,QACf,OAAQ,MACR,KAAM,EACN,OAAQ,CACP,IAAK,CAAC,eAUD,WAAqB,EAAQ,CACpC,MAAO,GAAM,CACZ,IAAK,EAAU,QACf,OAAQ,OACR,KAAM,EACN,OAAQ,CACP,IAAK,CAAC,eAuBD,WAAuB,EAAQ,CACtC,MAAO,GAAM,CACZ,IAAK,EAAU,QACf,OAAQ,SACR,KAAM,IASA,WAAsB,EAAQ,CACrC,MAAO,GAAM,CACZ,IAAK,EAAU,cACf,OAAQ,OACR,KAAM,IASA,WAA4B,EAAQ,CAC3C,MAAO,GAAM,CACZ,IAAK,EAAU,oBACf,OAAQ,OACR,KAAM,IASA,WAA6B,EAAQ,CAC5C,MAAO,GAAM,CACZ,IAAK,EAAU,qBACf,OAAQ,OACR,KAAM,EACN,OAAQ,CACP,IAAK,CAAC,eCnIT,GAAI,GAAS,UAAY,CAAC,GAAI,GAAI,KAAS,EAAG,EAAI,eAAmB,EAAG,EAAI,MAAM,IAAI,EAAG,MAAO,GAAG,YAAY,EAAI,GAAG,CAAC,MAAM,CAAC,MAAQ,EAAI,MAAM,MAAQ,MAAM,uBAAuB,IAAO,GAAG,CAAC,MAAQ,EAAI,OAAO,OAAS,EAAI,SAAS,YAAY,EAAI,OAAO,IAAO,CAAC,EAAG,UAAU,CAAC,IAAI,OAAO,MAAM,CAAC,MAAQ,EAAI,QAAQ,MAAQ,EAAI,MAAM,cAAc,OAAO,OAAS,GAAM,KAAO,UAAU,CAAC,EAAG,QAAQ,CAAC,YAAY,OAAO,MAAM,CAAC,KAAO,cAAc,EAAG,QAAQ,CAAC,YAAY,OAAO,MAAM,CAAC,KAAO,UAAU,EAAI,GAAI,EAAI,SAAU,SAAS,EAAM,EAAI,CAAC,MAAO,GAAG,eAAe,CAAC,IAAI,EAAI,MAAM,CAAC,MAAQ,EAAM,MAAM,KAAO,IAAM,CAAE,EAAI,SAAS,SAAS,GAAM,EAAI,GAAG,EAAI,KAAK,CAAC,OAAS,EAAI,QAAQ,OAAS,IAAM,EAAG,WAAW,CAAC,MAAM,CAAC,KAAO,EAAM,KAAO,EAAM,KAAO,IAAI,MAAM,CAAC,MAAO,EAAI,QAAQ,GAAM,SAAS,SAAU,EAAK,CAAC,EAAI,KAAK,EAAI,QAAS,EAAK,IAAM,WAAW,mBAAmB,KAAK,EAAG,MAAM,CAAC,YAAY,eAAe,CAAC,EAAG,YAAY,CAAC,MAAM,CAAC,KAAO,WAAW,GAAG,CAAC,MAAQ,EAAI,SAAS,CAAC,EAAI,GAAG,kBAAQ,EAAG,YAAY,CAAC,GAAG,CAAC,MAAQ,EAAI,SAAS,CAAC,EAAI,GAAG,mBAAS,IAAI,IAAI,IAC3iC,EAAkB,GC+BtB"}